-- lsyncd configuration for backing up to Samba share
-- This file should be placed in /etc/lsyncd/lsyncd.conf.lua
-- or specified with -config option

settings {
    logfile = "/var/log/lsyncd/lsyncd.log",
    statusFile = "/var/log/lsyncd/lsyncd.status",
    statusInterval = 20,
    nodaemon = false,
    inotifyMode = "CloseWrite",
    maxProcesses = 1,
    maxDelays = 1,
}

-- Sync configuration
-- Adjust source and target paths as needed
sync {
    default.rsync,
    source = "/home",
    target = "/mnt/samba-backup",
    exclude = {
        -- Temporary files and caches
        ".*/.*cache.*",
        ".*/.*Cache.*",
        ".*/.*tmp.*",
        ".*/.*Tmp.*",
        ".*/.*temp.*",
        ".*/.*Temp.*",
        ".*/.cache/",
        ".*/.tmp/",
        ".*/.temp/",
        
        -- Browser caches
        ".*/.mozilla/.*cache.*",
        ".*/.mozilla/firefox/.*/cache.*",
        ".*/.chromium/.*/Cache.*",
        ".*/.google-chrome/.*/Cache.*",
        
        -- Trash
        ".*/.Trash/",
        ".*/.local/share/Trash/",
        
        -- System files
        ".*/.thumbnails/",
        ".*/.recently-used",
        ".*/.Xauthority",
        ".*/.ICEauthority",
        
        -- Package manager caches
        ".*/.npm/",
        ".*/.pip/",
        ".*/.cargo/registry/",
        
        -- Virtual environments (optional - uncomment if needed)
        -- ".*/.*venv/",
        -- ".*/.*virtualenv/",
        -- ".*/.virtualenvs/",
    },
    rsync = {
        archive = true,
        compress = false,
        verbose = false,
        _extra = {
            "--delete",
            "--delete-excluded",
        },
    },
    delay = 5,
}


